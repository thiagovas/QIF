#ifndef _channel_vulnerability_guessing_h
#define _channel_vulnerability_guessing_h

#include "../channel.h"
#include "vulnerability.h"

namespace channel {
namespace vulnerability {

class Guessing : public Vulnerability {
  public:
    // V(X)
    double VulnerabilityPrior(const Channel& channel) const;

    // V(Y)
    double VulnerabilityOut(const Channel& channel) const;

    // V(X|Y)
    double VulnerabilityPosterior(const Channel& channel) const;

    // V(Y|X)
    double VulnerabilityReversePosterior(const Channel& channel) const;
    
    // V(X|Y) = max_{y} p(y) * V(X|Y=y)  
    double VulnerabilityMaxPosterior(const Channel& channel) const;

    // V(Y|X) = max_{x} p(x) * V(Y|X=x)
    double VulnerabilityMaxReversePosterior(const Channel& channel) const;

    // L(X|Y) = V(X|Y) / V(X)
    double LeakageMaxPosterior(const Channel& channel) const;

    // L(Y|X) = V(Y|X) / V(Y)
    double LeakageMaxReversePosterior(const Channel& channel) const;
};

} // namespace vulnerability
} // namespace channel


#endif
